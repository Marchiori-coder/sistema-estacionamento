<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Estacionamento - Admin Completo</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        /* Reset e Base */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* Variáveis CSS para responsividade */
        :root {
            --container-padding: clamp(10px, 2vw, 40px);
            --header-padding: clamp(20px, 3vw, 60px);
            --font-size-h1: clamp(1.5rem, 4vw, 3rem);
            --font-size-body: clamp(0.8rem, 1.5vw, 1.1rem);
            --font-size-small: clamp(0.7rem, 1.2vw, 0.9rem);
            --gap-small: clamp(8px, 1.5vw, 15px);
            --gap-medium: clamp(15px, 2.5vw, 30px);
            --gap-large: clamp(20px, 4vw, 60px);
            --border-radius: clamp(8px, 1vw, 20px);
            --shadow-light: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-medium: 0 4px 20px rgba(0,0,0,0.15);
            --shadow-heavy: 0 8px 40px rgba(0,0,0,0.2);
        }
        
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
            padding: var(--container-padding);
            font-size: var(--font-size-body);
            line-height: 1.6;
        }
        
        /* Modal Login - Responsivo */
        .modal-login { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.9); 
            display: none; 
            justify-content: center; 
            align-items: center; 
            z-index: 10000; 
            padding: var(--container-padding);
        }
        .modal-login.show { display: flex !important; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .login-box { 
            background: white; 
            padding: clamp(20px, 5vw, 40px); 
            border-radius: var(--border-radius); 
            text-align: center; 
            max-width: min(400px, 90vw); 
            width: 100%; 
            animation: slideIn 0.3s ease; 
            box-shadow: var(--shadow-heavy);
        }
        @keyframes slideIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        .login-box h2 { 
            color: #2c3e50; 
            margin-bottom: var(--gap-medium); 
            font-size: clamp(1.3rem, 3vw, 2rem); 
        }
        .login-input { 
            width: 100%; 
            padding: clamp(10px, 2vw, 15px); 
            margin: var(--gap-small) 0; 
            border: 2px solid #ecf0f1; 
            border-radius: calc(var(--border-radius) / 2); 
            font-size: var(--font-size-body); 
        }
        .login-input:focus { outline: none; border-color: #3498db; }
        .login-btn { 
            width: 100%; 
            padding: clamp(12px, 2.5vw, 15px); 
            background: linear-gradient(135deg, #3498db, #2980b9); 
            color: white; 
            border: none; 
            border-radius: calc(var(--border-radius) / 2); 
            font-size: var(--font-size-body); 
            font-weight: bold; 
            cursor: pointer; 
            margin-top: var(--gap-small); 
        }
        .close-modal { 
            position: absolute; 
            top: 15px; 
            right: 20px; 
            background: none; 
            border: none; 
            font-size: clamp(1.5rem, 3vw, 2rem); 
            cursor: pointer; 
            color: #7f8c8d; 
        }

        /* Container Principal - Totalmente Responsivo */
        .container { 
            max-width: min(1800px, 95vw); 
            margin: 0 auto; 
            background: white; 
            border-radius: var(--border-radius); 
            box-shadow: var(--shadow-heavy); 
            overflow: hidden; 
        }
        
        .header { 
            background: linear-gradient(135deg, #2c3e50, #3498db); 
            color: white; 
            padding: var(--header-padding); 
            text-align: center; 
            position: relative; 
            padding-top: clamp(60px, 8vw, 120px); 
        }
        
        .header h1 { 
            font-size: var(--font-size-h1); 
            margin-bottom: var(--gap-small); 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3); 
            line-height: 1.2;
        }
        
        .user-info { 
            position: absolute; 
            top: clamp(15px, 3vw, 40px); 
            right: clamp(10px, 2vw, 20px); 
            background: rgba(255,255,255,0.25); 
            padding: clamp(8px, 1.5vw, 15px) clamp(15px, 3vw, 30px); 
            border-radius: 30px; 
            backdrop-filter: blur(15px); 
            display: flex; 
            align-items: center; 
            gap: var(--gap-small); 
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .user-badge { 
            background: #27ae60; 
            color: white; 
            padding: clamp(4px, 1vw, 8px) clamp(8px, 1.5vw, 16px); 
            border-radius: 20px; 
            font-size: var(--font-size-small); 
            font-weight: bold; 
        }
        .user-badge.admin { background: #f39c12; }
        
        .admin-login-btn, .logout-btn { 
            background: #3498db; 
            color: white; 
            border: none; 
            padding: clamp(6px, 1.2vw, 10px) clamp(10px, 2vw, 18px); 
            border-radius: 20px; 
            cursor: pointer; 
            font-size: var(--font-size-small); 
            font-weight: bold; 
            transition: all 0.3s; 
        }
        .logout-btn { background: #e74c3c; }
        .admin-login-btn:hover { background: #2980b9; transform: translateY(-2px); }
        .logout-btn:hover { background: #c0392b; transform: translateY(-2px); }

        /* Painel Admin - Responsivo */
        .admin-panel { 
            background: linear-gradient(135deg, #f39c12, #e67e22); 
            color: white; 
            padding: var(--gap-medium); 
            text-align: center; 
            display: none; 
        }
        .admin-panel.show { display: block !important; animation: slideDown 0.3s ease; }
        @keyframes slideDown { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .admin-controls { 
            display: flex; 
            justify-content: center; 
            gap: var(--gap-small); 
            flex-wrap: wrap; 
            margin-top: var(--gap-small); 
        }
        
        .admin-btn { 
            padding: clamp(8px, 1.5vw, 12px) clamp(12px, 2.5vw, 20px); 
            background: rgba(255,255,255,0.2); 
            color: white; 
            border: 2px solid white; 
            border-radius: 25px; 
            cursor: pointer; 
            font-weight: bold; 
            transition: all 0.3s; 
            font-size: var(--font-size-small); 
            white-space: nowrap;
        }
        .admin-btn:hover { background: white; color: #f39c12; transform: translateY(-2px); }
        .admin-btn.active { background: white; color: #f39c12; box-shadow: var(--shadow-medium); }

        /* Status Firebase - Responsivo */
        .status-firebase { 
            position: fixed; 
            top: var(--container-padding); 
            left: var(--container-padding); 
            padding: clamp(8px, 1.5vw, 12px) clamp(12px, 2.5vw, 20px); 
            border-radius: 25px; 
            color: white; 
            font-weight: bold; 
            z-index: 1000; 
            display: flex; 
            align-items: center; 
            gap: var(--gap-small); 
            font-size: var(--font-size-small);
        }
        .status-firebase.conectado { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        .status-firebase.desconectado { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .indicador-firebase { 
            width: clamp(8px, 1.5vw, 12px); 
            height: clamp(8px, 1.5vw, 12px); 
            border-radius: 50%; 
            background: white; 
            animation: pulse 2s infinite; 
        }
        @keyframes pulse { 0% { opacity: 1; transform: scale(1); } 50% { opacity: 0.7; transform: scale(1.2); } 100% { opacity: 1; transform: scale(1); } }

        /* Estatísticas - Grid Responsivo */
        .stats { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); 
            gap: var(--gap-medium); 
            margin-top: var(--gap-medium); 
        }
        
        .stat-box { 
            background: rgba(255,255,255,0.2); 
            padding: var(--gap-small) var(--gap-medium); 
            border-radius: calc(var(--border-radius) / 2); 
            text-align: center; 
            backdrop-filter: blur(10px); 
        }
        
        .stat-number { 
            font-size: clamp(1.2rem, 3vw, 2rem); 
            font-weight: bold; 
            display: block; 
        }

        /* Estacionamento - Totalmente Adaptativo */
        .estacionamento-wrapper { 
            padding: var(--container-padding); 
            background: #f8f9fa; 
            min-height: 50vh;
            position: relative; 
        }
        
        .estacionamento-container { 
            position: relative; 
            width: 100%; 
            max-width: min(1600px, 95vw); 
            height: clamp(400px, 60vh, 1000px); 
            margin: 0 auto; 
            background: #e8e8e8; 
            border-radius: var(--border-radius); 
            border: clamp(2px, 0.5vw, 4px) solid #34495e; 
            overflow: visible; 
            transform-origin: center center; 
            transition: transform 0.3s ease; 
        }
        
        .planta-baixa { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-size: contain; 
            background-repeat: no-repeat; 
            background-position: center; 
            opacity: 0.8; 
            z-index: 1; 
            transform-origin: center center; 
            transition: transform 0.3s ease; 
        }

        /* Controles de Zoom - Adaptativo */
        .zoom-controls { 
            position: absolute; 
            top: var(--gap-medium); 
            left: var(--gap-medium); 
            background: white; 
            padding: var(--gap-small); 
            border-radius: calc(var(--border-radius) / 2); 
            box-shadow: var(--shadow-medium); 
            z-index: 100; 
            display: none;
        }
        
        .zoom-controls h4 { 
            margin-bottom: var(--gap-small); 
            color: #2c3e50; 
            font-size: var(--font-size-small); 
        }
        
        .zoom-btn { 
            padding: clamp(6px, 1vw, 8px) clamp(8px, 1.5vw, 12px); 
            margin: 2px; 
            background: #3498db; 
            color: white; 
            border: none; 
            border-radius: calc(var(--border-radius) / 4); 
            cursor: pointer; 
            font-weight: bold; 
            font-size: var(--font-size-small); 
        }
        .zoom-btn:hover { background: #2980b9; }
        
        .zoom-info { 
            font-size: var(--font-size-small); 
            color: #7f8c8d; 
            margin-top: var(--gap-small); 
            text-align: center; 
        }

        /* Vagas - Responsivas por Viewport */
        .vaga { 
            position: absolute; 
            width: clamp(25px, 4vw, 50px); 
            height: clamp(40px, 6vw, 80px); 
            border: clamp(1px, 0.3vw, 3px) solid #2c3e50; 
            background-color: rgba(39, 174, 96, 0.9); 
            display: flex !important; 
            justify-content: center; 
            align-items: center; 
            font-size: clamp(6px, 1.2vw, 12px); 
            font-weight: bold; 
            color: white; 
            border-radius: clamp(2px, 0.5vw, 6px); 
            cursor: pointer; 
            transition: all 0.3s ease; 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7); 
            box-shadow: var(--shadow-light); 
            z-index: 10; 
            user-select: none; 
        }
        
        .vaga:hover { 
            transform: scale(1.1); 
            z-index: 100; 
            box-shadow: var(--shadow-medium); 
        }
        
        .livre { background-color: rgba(39, 174, 96, 0.9) !important; border-color: #27ae60 !important; }
        .ocupada { background-color: rgba(231, 76, 60, 0.9) !important; border-color: #e74c3c !important; }
        
        .modo-edicao .vaga { 
            cursor: move !important; 
            border: clamp(2px, 0.4vw, 4px) dashed #f39c12 !important; 
            background-color: rgba(243, 156, 18, 0.8) !important; 
        }
        
        .modo-edicao .vaga:hover { 
            transform: scale(1.15) !important; 
            box-shadow: 0 8px 25px rgba(243, 156, 18, 0.5) !important; 
        }
        
        .vaga.selecionada { 
            border: clamp(2px, 0.5vw, 5px) solid #9b59b6 !important; 
            background-color: rgba(155, 89, 182, 0.9) !important; 
            box-shadow: 0 0 20px rgba(155, 89, 182, 0.8) !important; 
            z-index: 1000 !important; 
        }
        
        .vaga.multipla-selecionada { 
            border: clamp(2px, 0.5vw, 5px) solid #e67e22 !important; 
            background-color: rgba(230, 126, 34, 0.9) !important; 
            box-shadow: 0 0 15px rgba(230, 126, 34, 0.6) !important; 
            z-index: 999 !important; 
        }
        
        .vaga.arrastando { 
            z-index: 1001 !important; 
            transform: scale(1.3) rotate(5deg) !important; 
            box-shadow: var(--shadow-heavy) !important; 
            opacity: 0.9; 
        }

        /* Controles de Edição - Responsivos */
        .edit-controls { 
            position: fixed; 
            top: 50%; 
            right: var(--container-padding); 
            transform: translateY(-50%); 
            background: white; 
            padding: var(--gap-medium); 
            border-radius: var(--border-radius); 
            box-shadow: var(--shadow-heavy); 
            display: none; 
            z-index: 1000; 
            min-width: clamp(250px, 25vw, 350px); 
            max-width: 90vw;
            max-height: 85vh; 
            overflow-y: auto; 
        }
        
        .edit-controls.show { display: block !important; animation: slideInRight 0.3s ease; }
        @keyframes slideInRight { from { transform: translateY(-50%) translateX(100%); opacity: 0; } to { transform: translateY(-50%) translateX(0); opacity: 1; } }
        
        .edit-title { 
            text-align: center; 
            margin-bottom: var(--gap-medium); 
            color: #2c3e50; 
            font-weight: bold; 
            font-size: var(--font-size-body); 
            padding-bottom: var(--gap-small); 
            border-bottom: 2px solid #ecf0f1; 
        }
        
        .edit-section { margin-bottom: var(--gap-medium); }
        .edit-section h4 { 
            color: #34495e; 
            margin-bottom: var(--gap-small); 
            font-size: var(--font-size-small); 
        }
        
        .edit-btn { 
            width: 100%; 
            padding: clamp(8px, 1.5vw, 12px); 
            margin: clamp(3px, 0.5vw, 6px) 0; 
            border: none; 
            border-radius: calc(var(--border-radius) / 2); 
            cursor: pointer; 
            font-weight: bold; 
            transition: all 0.3s; 
            font-size: var(--font-size-small); 
        }
        
        .edit-btn.rotate { background: #3498db; color: white; }
        .edit-btn.resize { background: #e67e22; color: white; }
        .edit-btn.action { background: #9b59b6; color: white; }
        .edit-btn.delete { background: #e74c3c; color: white; }
        .edit-btn.multi { background: #27ae60; color: white; }
        .edit-btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-light); }
        
        .size-controls { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: var(--gap-small); 
            margin: var(--gap-small) 0; 
        }
        
        .size-btn { 
            padding: clamp(6px, 1.2vw, 10px); 
            background: #95a5a6; 
            color: white; 
            border: none; 
            border-radius: calc(var(--border-radius) / 3); 
            cursor: pointer; 
            font-size: var(--font-size-small); 
            font-weight: bold; 
        }
        
        .position-controls { 
            display: grid; 
            grid-template-columns: 1fr 1fr 1fr; 
            gap: clamp(3px, 0.5vw, 5px); 
            margin: var(--gap-small) 0; 
        }
        
        .position-btn { 
            padding: clamp(4px, 1vw, 8px); 
            background: #2c3e50; 
            color: white; 
            border: none; 
            border-radius: calc(var(--border-radius) / 4); 
            cursor: pointer; 
            font-size: var(--font-size-small); 
            font-weight: bold; 
        }

        /* Seleção múltipla */
        .selection-area { 
            position: absolute; 
            border: 2px dashed #e67e22; 
            background: rgba(230, 126, 34, 0.1); 
            z-index: 500; 
            pointer-events: none; 
            display: none; 
        }
        
        .multi-selection-info { 
            background: #e67e22; 
            color: white; 
            padding: var(--gap-small); 
            border-radius: calc(var(--border-radius) / 2); 
            margin-bottom: var(--gap-small); 
            text-align: center; 
            font-size: var(--font-size-small); 
        }

        /* Controles Principais - Grid Responsivo */
        .controles { 
            padding: var(--gap-large); 
            background: #ecf0f1; 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); 
            gap: var(--gap-medium); 
            justify-items: center;
        }
        
        .btn { 
            padding: clamp(10px, 2vw, 15px) clamp(15px, 3vw, 30px); 
            border: none; 
            border-radius: 25px; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: var(--font-size-small); 
            transition: all 0.3s ease; 
            box-shadow: var(--shadow-medium); 
            text-transform: uppercase; 
            letter-spacing: 1px; 
            min-width: 120px;
            white-space: nowrap;
        }
        
        .btn:hover { transform: translateY(-3px); box-shadow: var(--shadow-heavy); }
        .btn:disabled { opacity: 0.3; cursor: not-allowed; transform: none; }
        
        .btn-reset { background: linear-gradient(135deg, #95a5a6, #7f8c8d); color: white; }
        .btn-ocupar { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; }
        .btn-liberar { background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; }
        .btn-salvar { background: linear-gradient(135deg, #3498db, #2980b9); color: white; }
        .btn-firebase { background: linear-gradient(135deg, #ff9800, #f57c00); color: white; }

        /* Notificações - Responsivas */
        .notificacao { 
            position: fixed; 
            bottom: var(--container-padding); 
            right: var(--container-padding); 
            background: #2c3e50; 
            color: white; 
            padding: var(--gap-small) var(--gap-medium); 
            border-radius: calc(var(--border-radius) / 2); 
            z-index: 1000; 
            max-width: min(350px, 90vw); 
            transform: translateX(400px); 
            transition: transform 0.3s ease; 
            font-size: var(--font-size-small);
        }
        
        .notificacao.mostrar { transform: translateX(0); }
        .notificacao.sucesso { background: #27ae60; }
        .notificacao.erro { background: #e74c3c; }
        .notificacao.info { background: #3498db; }

        /* Media Queries Específicas para Dispositivos */
        
        /* Smartphones Portrait (320px - 480px) */
        @media screen and (max-width: 480px) {
            .user-info {
                position: static;
                margin-bottom: var(--gap-small);
                justify-content: center;
            }
            
            .header {
                padding-top: var(--gap-medium);
            }
            
            .edit-controls {
                position: fixed;
                top: 0;
                right: 0;
                left: 0;
                bottom: 0;
                transform: none;
                max-height: 100vh;
                border-radius: 0;
                padding: var(--gap-medium);
            }
            
            .estacionamento-container {
                height: 50vh;
            }
            
            .vaga {
                width: clamp(20px, 6vw, 30px);
                height: clamp(35px, 8vw, 50px);
                font-size: clamp(5px, 1.5vw, 8px);
            }
            
            .zoom-controls {
                position: relative;
                margin-bottom: var(--gap-small);
            }
        }
        
        /* Smartphones Landscape (481px - 768px) */
        @media screen and (min-width: 481px) and (max-width: 768px) {
            .estacionamento-container {
                height: 60vh;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .controles {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Tablets (769px - 1024px) */
        @media screen and (min-width: 769px) and (max-width: 1024px) {
            .estacionamento-container {
                height: 70vh;
            }
            
            .stats {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .controles {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        /* Desktop Small (1025px - 1440px) */
        @media screen and (min-width: 1025px) and (max-width: 1440px) {
            .estacionamento-container {
                height: 80vh;
            }
        }
        
        /* Desktop Large (1441px - 1920px) */
        @media screen and (min-width: 1441px) and (max-width: 1920px) {
            .estacionamento-container {
                height: 85vh;
            }
            
            .vaga {
                width: clamp(40px, 3vw, 60px);
                height: clamp(70px, 5vw, 90px);
                font-size: clamp(10px, 1vw, 14px);
            }
        }
        
        /* Ultra Wide (1921px+) */
        @media screen and (min-width: 1921px) {
            .container {
                max-width: 2000px;
            }
            
            .estacionamento-container {
                height: 90vh;
                max-width: 1800px;
            }
            
            .vaga {
                width: clamp(50px, 2.5vw, 70px);
                height: clamp(80px, 4vw, 110px);
                font-size: clamp(12px, 0.8vw, 16px);
            }
        }
        
        /* Orientação Landscape para Mobile */
        @media screen and (max-height: 500px) and (orientation: landscape) {
            .header {
                padding: var(--gap-small);
                padding-top: var(--gap-medium);
            }
            
            .estacionamento-container {
                height: 70vh;
            }
            
            .edit-controls {
                max-height: 90vh;
            }
        }
        
        /* High DPI Displays */
        @media screen and (-webkit-min-device-pixel-ratio: 2), 
               screen and (min-resolution: 192dpi) {
            .vaga {
                border-width: 1px;
            }
            
            .login-input, .edit-btn, .btn {
                border-width: 1px;
            }
        }
        
        /* Modo escuro para dispositivos que suportam */
        @media (prefers-color-scheme: dark) {
            .container {
                background: #2c3e50;
                color: white;
            }
            
            .estacionamento-wrapper {
                background: #34495e;
            }
            
            .edit-controls {
                background: #2c3e50;
                color: white;
            }
        }
        
        /* Redução de movimento para acessibilidade */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Print styles */
        @media print {
            .admin-panel, .edit-controls, .zoom-controls, .controles {
                display: none !important;
            }
            
            .container {
                box-shadow: none;
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body>
    <!-- Modal de Login -->
    <div class="modal-login" id="modal-login">
        <div class="login-box">
            <button class="close-modal" onclick="fecharModalLogin()">×</button>
            <h2>🔐 Login Administrador</h2>
            <input type="text" class="login-input" id="username" placeholder="Usuário" value="admin">
            <input type="password" class="login-input" id="password" placeholder="Senha" value="admin123">
            <button class="login-btn" onclick="fazerLoginAdmin()">Entrar como Admin</button>
        </div>
    </div>

    <!-- Status Firebase -->
    <div class="status-firebase" id="status-firebase">
        <div class="indicador-firebase"></div>
        <span id="texto-firebase">Sistema Inicializado</span>
    </div>

    <div class="container">
        <div class="header">
            <div class="user-info">
                <span id="user-name">Visualizador Público</span>
                <span class="user-badge" id="user-badge">VIEWER</span>
                <button class="admin-login-btn" id="admin-login-btn" onclick="mostrarModalLogin()">Login Admin</button>
                <button class="logout-btn" id="logout-btn" onclick="logout()" style="display: none;">Sair</button>
            </div>
            
            <h1>🚗 Sistema de Estacionamento</h1>
            <p id="modo-operacao">Consulte a disponibilidade das vagas em tempo real</p>
            <p><strong>Última atualização:</strong> <span id="ultima-atualizacao">Agora</span></p>
            
            <div class="stats">
                <div class="stat-box"><span class="stat-number" id="total-vagas">62</span><span>Total de Vagas</span></div>
                <div class="stat-box"><span class="stat-number" id="vagas-livres">62</span><span>Vagas Livres</span></div>
                <div class="stat-box"><span class="stat-number" id="vagas-ocupadas">0</span><span>Vagas Ocupadas</span></div>
                <div class="stat-box"><span class="stat-number" id="taxa-ocupacao">0%</span><span>Taxa de Ocupação</span></div>
            </div>
        </div>

        <!-- Painel Admin -->
        <div class="admin-panel" id="admin-panel">
            <h3>🔧 Painel de Administração Ativo</h3>
            <p>Você tem acesso completo para editar vagas, mapas e configurações do sistema</p>
            <div class="admin-controls">
                <button class="admin-btn" id="btn-edit-mode" onclick="toggleEditMode()">✏️ Modo Edição</button>
                <button class="admin-btn" onclick="adicionarNovaVaga()">➕ Nova Vaga</button>
                <button class="admin-btn" onclick="carregarPlantaBaixa()">🖼️ Planta Baixa</button>
                <button class="admin-btn" onclick="exportarLayout()">📤 Exportar</button>
                <button class="admin-btn" onclick="importarLayout()">📥 Importar</button>
                <button class="admin-btn" id="btn-multi-select" onclick="toggleSelecaoMultipla()">🔲 Seleção Múltipla</button>
            </div>
        </div>

        <div class="estacionamento-wrapper">
            <!-- Controles de Zoom -->
            <div class="zoom-controls" id="zoom-controls" style="display: none;">
                <h4>🔍 Controles de Zoom</h4>
                <div>
                    <button class="zoom-btn" onclick="ajustarZoom('container', 0.1)">🔍+</button>
                    <button class="zoom-btn" onclick="ajustarZoom('container', -0.1)">🔍-</button>
                    <button class="zoom-btn" onclick="resetarZoom('container')">⟲</button>
                </div>
                <div style="margin-top: 8px;">
                    <button class="zoom-btn" onclick="ajustarZoom('planta', 0.1)">🖼️+</button>
                    <button class="zoom-btn" onclick="ajustarZoom('planta', -0.1)">🖼️-</button>
                    <button class="zoom-btn" onclick="resetarZoom('planta')">⟲🖼️</button>
                </div>
                <div class="zoom-info">
                    Container: <span id="zoom-container">100%</span><br>
                    Planta: <span id="zoom-planta">100%</span>
                </div>
            </div>

            <div class="estacionamento-container" id="mapa-estacionamento">
                <div class="planta-baixa" id="planta-baixa"></div>
                <div class="selection-area" id="selection-area"></div>
            </div>
        </div>

        <!-- Controles de Edição -->
        <div class="edit-controls" id="edit-controls">
            <div class="edit-title">🔧 Editando: <span id="vaga-selecionada">-</span></div>
            
            <!-- Seção de seleção múltipla -->
            <div class="multi-selection-info" id="multi-selection-info" style="display: none;">
                <span id="multi-count">0</span> vagas selecionadas
            </div>

            <div class="edit-section" id="multi-actions" style="display: none;">
                <h4>🔲 Ações em Lote</h4>
                <button class="edit-btn multi" onclick="aplicarRotacaoMultipla(-90)">↶ Rotacionar -90°</button>
                <button class="edit-btn multi" onclick="aplicarRotacaoMultipla(90)">↷ Rotacionar +90°</button>
                <button class="edit-btn multi" onclick="redimensionarMultiplas('width', 5)">📏 Largura +</button>
                <button class="edit-btn multi" onclick="redimensionarMultiplas('width', -5)">📏 Largura -</button>
                <button class="edit-btn multi" onclick="redimensionarMultiplas('height', 5)">📏 Altura +</button>
                <button class="edit-btn multi" onclick="redimensionarMultiplas('height', -5)">📏 Altura -</button>
                <button class="edit-btn multi" onclick="alinharVagasMultiplas('horizontal')">↔️ Alinhar H</button>
                <button class="edit-btn multi" onclick="alinharVagasMultiplas('vertical')">↕️ Alinhar V</button>
                <button class="edit-btn delete" onclick="excluirVagasMultiplas()">🗑️ Excluir Todas</button>
                <button class="edit-btn action" onclick="limparSelecaoMultipla()">❌ Limpar Seleção</button>
            </div>
            
            <div class="edit-section">
                <h4>📍 Posição Precisa</h4>
                <div class="position-controls">
                    <button class="position-btn" onclick="moverVaga(-10, -10)">↖</button>
                    <button class="position-btn" onclick="moverVaga(0, -10)">↑</button>
                    <button class="position-btn" onclick="moverVaga(10, -10)">↗</button>
                    <button class="position-btn" onclick="moverVaga(-10, 0)">←</button>
                    <button class="position-btn" onclick="centralizarVaga()">⌖</button>
                    <button class="position-btn" onclick="moverVaga(10, 0)">→</button>
                    <button class="position-btn" onclick="moverVaga(-10, 10)">↙</button>
                    <button class="position-btn" onclick="moverVaga(0, 10)">↓</button>
                    <button class="position-btn" onclick="moverVaga(10, 10)">↘</button>
                </div>
                <div style="display: flex; gap: 5px; margin-top: 8px;">
                    <button class="position-btn" onclick="moverVaga(-1, 0)" style="flex: 1;">◀1px</button>
                    <button class="position-btn" onclick="moverVaga(1, 0)" style="flex: 1;">1px▶</button>
                    <button class="position-btn" onclick="moverVaga(0, -1)" style="flex: 1;">▲1px</button>
                    <button class="position-btn" onclick="moverVaga(0, 1)" style="flex: 1;">1px▼</button>
                </div>
            </div>
            
            <div class="edit-section">
                <h4>🔄 Rotação</h4>
                <button class="edit-btn rotate" onclick="rotacionarVaga(-90)">↶ -90°</button>
                <button class="edit-btn rotate" onclick="rotacionarVaga(-15)">↺ -15°</button>
                <button class="edit-btn rotate" onclick="rotacionarVaga(15)">↻ +15°</button>
                <button class="edit-btn rotate" onclick="rotacionarVaga(90)">↷ +90°</button>
                <button class="edit-btn rotate" onclick="resetarRotacao()">⟲ Reset</button>
            </div>
            
            <div class="edit-section">
                <h4>📏 Redimensionar</h4>
                <div class="size-controls">
                    <button class="size-btn" onclick="redimensionarVaga('width', -5)">Largura -</button>
                    <button class="size-btn" onclick="redimensionarVaga('width', 5)">Largura +</button>
                    <button class="size-btn" onclick="redimensionarVaga('height', -5)">Altura -</button>
                    <button class="size-btn" onclick="redimensionarVaga('height', 5)">Altura +</button>
                </div>
                <button class="edit-btn resize" onclick="resetarTamanho()">📏 Tamanho Padrão</button>
            </div>
            
            <div class="edit-section">
                <h4>🎨 Ações</h4>
                <button class="edit-btn action" onclick="duplicarVaga()">📋 Duplicar</button>
                <button class="edit-btn action" onclick="renomearVaga()">✏️ Renomear</button>
                <button class="edit-btn delete" onclick="excluirVaga()">🗑️ Excluir</button>
            </div>
            
            <div class="edit-section">
                <h4>📊 Informações</h4>
                <div style="font-size: 0.85em; color: #7f8c8d; line-height: 1.4;">
                    <div>X: <span id="pos-x">-</span>px | Y: <span id="pos-y">-</span>px</div>
                    <div>W: <span id="size-w">-</span>px | H: <span id="size-h">-</span>px</div>
                    <div>Rotação: <span id="angle">-</span>°</div>
                </div>
            </div>
        </div>

        <div class="controles">
            <button class="btn btn-reset" onclick="resetarTodasVagas()" id="btn-reset" disabled>🔄 Resetar</button>
            <button class="btn btn-ocupar" onclick="ocuparTodasVagas()" id="btn-ocupar" disabled>🚗 Ocupar</button>
            <button class="btn btn-liberar" onclick="liberarTodasVagas()" id="btn-liberar" disabled>✅ Liberar</button>
            <button class="btn btn-salvar" onclick="salvarEstadoLocal()">💾 Salvar</button>
            <button class="btn btn-firebase" onclick="salvarNoFirebase()">🌐 Firebase</button>
        </div>
    </div>

    <!-- Inputs ocultos -->
    <input type="file" id="import-input" accept=".json" style="display: none;" onchange="processarImportacao(event)">
    <input type="file" id="planta-input" accept="image/*" style="display: none;" onchange="processarPlantaBaixa(event)">

    <script>
        // Configuração Firebase
        var firebaseConfig = {
            apiKey: "AIzaSyCRIgCndKlfXxR7NNnq_qGupgAWyLqzYzc",
            authDomain: "teste-dbacd.firebaseapp.com",
            databaseURL: "https://teste-dbacd-default-rtdb.firebaseio.com/",
            projectId: "teste-dbacd",
            storageBucket: "teste-dbacd.firebasestorage.app",
            messagingSenderId: "381642195685",
            appId: "1:381642195685:web:746eb4df7667813b0e4a0c"
        };

        // Variáveis Globais
        var estadoVagas = {}, posicaoVagas = {}, firebaseConectado = false, database = null, totalVagas = 62, usuarioAtual = 'viewer', tipoUsuario = 'viewer', modoEdicao = false, proximoIdVaga = 63, vagaSelecionada = null, vagaArrastando = null, offsetX = 0, offsetY = 0;
        
        // Novas variáveis para funcionalidades adicionadas
        var zoomContainer = 1, zoomPlanta = 1, selecaoMultipla = false, vagasMultiplasSelecao = [], arrasteSelecionando = false, inicioSelecao = {x: 0, y: 0};

        // Função para detectar tipo de dispositivo
        function detectarDispositivo() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTablet = isMobile && Math.min(width, height) >= 768;
            const isDesktop = !isMobile && width >= 1024;
            
            return {
                isMobile: isMobile && !isTablet,
                isTablet: isTablet,
                isDesktop: isDesktop,
                width: width,
                height: height,
                aspectRatio: width / height
            };
        }

        // Função para ajustar layout baseado no dispositivo
        function ajustarLayoutResponsivo() {
            const dispositivo = detectarDispositivo();
            const container = document.getElementById('mapa-estacionamento');
            const vagas = document.querySelectorAll('.vaga');
            
            // Ajustar container baseado no dispositivo
            if (dispositivo.isMobile) {
                container.style.height = '50vh';
                // Ajustar posições das vagas para mobile
                vagas.forEach(vaga => {
                    const vagaId = vaga.id;
                    if (posicaoVagas[vagaId]) {
                        const scaleFactor = 0.7;
                        posicaoVagas[vagaId].x *= scaleFactor;
                        posicaoVagas[vagaId].y *= scaleFactor;
                        vaga.style.left = posicaoVagas[vagaId].x + 'px';
                        vaga.style.top = posicaoVagas[vagaId].y + 'px';
                    }
                });
            } else if (dispositivo.isTablet) {
                container.style.height = '65vh';
            } else if (dispositivo.isDesktop) {
                if (dispositivo.width >= 1920) {
                    container.style.height = '85vh';
                } else {
                    container.style.height = '75vh';
                }
            }
            
            // Ajustar controles de edição para mobile
            const editControls = document.getElementById('edit-controls');
            if (dispositivo.isMobile && editControls.style.display === 'block') {
                editControls.style.position = 'fixed';
                editControls.style.top = '0';
                editControls.style.right = '0';
                editControls.style.bottom = '0';
                editControls.style.left = '0';
                editControls.style.transform = 'none';
                editControls.style.maxHeight = '100vh';
                editControls.style.borderRadius = '0';
            }
        }

        // Função para otimizar performance baseada no dispositivo
        function otimizarPerformance() {
            const dispositivo = detectarDispositivo();
            
            if (dispositivo.isMobile) {
                // Reduzir animações em dispositivos móveis
                document.documentElement.style.setProperty('--animation-duration', '0.1s');
                // Simplificar sombras
                document.documentElement.style.setProperty('--shadow-light', '0 1px 3px rgba(0,0,0,0.1)');
                document.documentElement.style.setProperty('--shadow-medium', '0 2px 6px rgba(0,0,0,0.1)');
                document.documentElement.style.setProperty('--shadow-heavy', '0 4px 12px rgba(0,0,0,0.1)');
            } else {
                // Animações completas para desktop
                document.documentElement.style.setProperty('--animation-duration', '0.3s');
            }
        }

        // Funções de Login
        function mostrarModalLogin() { document.getElementById('modal-login').classList.add('show'); }
        function fecharModalLogin() { document.getElementById('modal-login').classList.remove('show'); }
        
        function fazerLoginAdmin() {
            var username = document.getElementById('username').value.trim();
            var password = document.getElementById('password').value.trim();
            if (!username || !password) { mostrarNotificacao('❌ Preencha usuário e senha', 'erro'); return; }
            if (username === 'admin' && password === 'admin123') {
                usuarioAtual = 'admin'; tipoUsuario = 'admin'; fecharModalLogin();
                document.getElementById('user-name').textContent = 'Administrador';
                document.getElementById('user-badge').textContent = 'ADMIN';
                document.getElementById('user-badge').className = 'user-badge admin';
                document.getElementById('admin-login-btn').style.display = 'none';
                document.getElementById('logout-btn').style.display = 'inline-block';
                document.getElementById('admin-panel').classList.add('show');
                document.getElementById('zoom-controls').style.display = 'block';
                habilitarControlesAdmin();
                mostrarNotificacao('🔧 Login de administrador realizado!', 'sucesso');
            } else { mostrarNotificacao('❌ Credenciais inválidas', 'erro'); }
        }

        function logout() {
            if (confirm('Sair do modo administrador?')) {
                usuarioAtual = 'viewer'; tipoUsuario = 'viewer'; modoEdicao = false; selecaoMultipla = false;
                document.getElementById('user-name').textContent = 'Visualizador Público';
                document.getElementById('user-badge').textContent = 'VIEWER';
                document.getElementById('user-badge').className = 'user-badge';
                document.getElementById('admin-login-btn').style.display = 'inline-block';
                document.getElementById('logout-btn').style.display = 'none';
                document.getElementById('admin-panel').classList.remove('show');
                document.getElementById('edit-controls').style.display = 'none';
                document.getElementById('zoom-controls').style.display = 'none';
                document.getElementById('mapa-estacionamento').classList.remove('modo-edicao');
                limparSelecaoMultipla();
                desabilitarControlesAdmin();
                mostrarNotificacao('👋 Logout realizado', 'info');
            }
        }

        function habilitarControlesAdmin() { ['btn-reset', 'btn-ocupar', 'btn-liberar'].forEach(id => { var btn = document.getElementById(id); if (btn) { btn.disabled = false; btn.style.opacity = '1'; } }); }
        function desabilitarControlesAdmin() { ['btn-reset', 'btn-ocupar', 'btn-liberar'].forEach(id => { var btn = document.getElementById(id); if (btn) { btn.disabled = true; btn.style.opacity = '0.3'; } }); }

        // Funções de Zoom
        function ajustarZoom(tipo, incremento) {
            if (tipoUsuario !== 'admin') return;
            
            if (tipo === 'container') {
                zoomContainer = Math.max(0.3, Math.min(3, zoomContainer + incremento));
                document.getElementById('mapa-estacionamento').style.transform = `scale(${zoomContainer})`;
                document.getElementById('zoom-container').textContent = Math.round(zoomContainer * 100) + '%';
            } else if (tipo === 'planta') {
                zoomPlanta = Math.max(0.3, Math.min(3, zoomPlanta + incremento));
                document.getElementById('planta-baixa').style.transform = `scale(${zoomPlanta})`;
                document.getElementById('zoom-planta').textContent = Math.round(zoomPlanta * 100) + '%';
            }
            
            mostrarNotificacao(`🔍 Zoom ${tipo}: ${Math.round((tipo === 'container' ? zoomContainer : zoomPlanta) * 100)}%`, 'info');
        }

        function resetarZoom(tipo) {
            if (tipoUsuario !== 'admin') return;
            
            if (tipo === 'container') {
                zoomContainer = 1;
                document.getElementById('mapa-estacionamento').style.transform = 'scale(1)';
                document.getElementById('zoom-container').textContent = '100%';
            } else if (tipo === 'planta') {
                zoomPlanta = 1;
                document.getElementById('planta-baixa').style.transform = 'scale(1)';
                document.getElementById('zoom-planta').textContent = '100%';
            }
            
            mostrarNotificacao(`⟲ Zoom ${tipo} resetado`, 'info');
        }

        // Seleção Múltipla
        function toggleSelecaoMultipla() {
            if (tipoUsuario !== 'admin') return;
            
            selecaoMultipla = !selecaoMultipla;
            var btn = document.getElementById('btn-multi-select');
            
            if (selecaoMultipla) {
                btn.classList.add('active');
                btn.textContent = '✅ Seleção Ativa';
                mostrarNotificacao('🔲 Modo seleção múltipla ativado', 'info');
            } else {
                btn.classList.remove('active');
                btn.textContent = '🔲 Seleção Múltipla';
                limparSelecaoMultipla();
                mostrarNotificacao('❌ Seleção múltipla desativada', 'info');
            }
        }

        function limparSelecaoMultipla() {
            vagasMultiplasSelecao.forEach(vaga => {
                vaga.classList.remove('multipla-selecionada');
            });
            vagasMultiplasSelecao = [];
            atualizarInterfaceSelecaoMultipla();
        }

        function adicionarVagaSelecaoMultipla(vaga) {
            if (!selecaoMultipla) return;
            
            var index = vagasMultiplasSelecao.indexOf(vaga);
            if (index > -1) {
                vagasMultiplasSelecao.splice(index, 1);
                vaga.classList.remove('multipla-selecionada');
            } else {
                vagasMultiplasSelecao.push(vaga);
                vaga.classList.add('multipla-selecionada');
            }
            
            atualizarInterfaceSelecaoMultipla();
        }

        function atualizarInterfaceSelecaoMultipla() {
            var count = vagasMultiplasSelecao.length;
            var multiInfo = document.getElementById('multi-selection-info');
            var multiActions = document.getElementById('multi-actions');
            
            if (count > 0) {
                multiInfo.style.display = 'block';
                multiActions.style.display = 'block';
                document.getElementById('multi-count').textContent = count;
                document.getElementById('edit-controls').style.display = 'block';
            } else {
                multiInfo.style.display = 'none';
                multiActions.style.display = 'none';
                if (!vagaSelecionada) {
                    document.getElementById('edit-controls').style.display = 'none';
                }
            }
        }

        // Ações em lote para seleção múltipla
        function aplicarRotacaoMultipla(graus) {
            if (vagasMultiplasSelecao.length === 0) {
                mostrarNotificacao('❌ Nenhuma vaga selecionada', 'erro');
                return;
            }
            
            vagasMultiplasSelecao.forEach(vaga => {
                var vagaId = vaga.id;
                var novoAngulo = ((posicaoVagas[vagaId].angle || 0) + graus) % 360;
                posicaoVagas[vagaId].angle = novoAngulo;
                vaga.style.transform = 'rotate(' + novoAngulo + 'deg)';
            });
            
            mostrarNotificacao(`🔄 ${vagasMultiplasSelecao.length} vagas rotacionadas ${graus}°`, 'sucesso');
        }

        function redimensionarMultiplas(dimensao, valor) {
            if (vagasMultiplasSelecao.length === 0) {
                mostrarNotificacao('❌ Nenhuma vaga selecionada', 'erro');
                return;
            }
            
            vagasMultiplasSelecao.forEach(vaga => {
                var vagaId = vaga.id;
                if (!posicaoVagas[vagaId].width) posicaoVagas[vagaId].width = 40;
                if (!posicaoVagas[vagaId].height) posicaoVagas[vagaId].height = 70;
                
                if (dimensao === 'width') {
                    posicaoVagas[vagaId].width = Math.max(15, posicaoVagas[vagaId].width + valor);
                    vaga.style.width = posicaoVagas[vagaId].width + 'px';
                } else {
                    posicaoVagas[vagaId].height = Math.max(20, posicaoVagas[vagaId].height + valor);
                    vaga.style.height = posicaoVagas[vagaId].height + 'px';
                }
            });
            
            mostrarNotificacao(`📏 ${vagasMultiplasSelecao.length} vagas redimensionadas`, 'sucesso');
        }

        function alinharVagasMultiplas(tipo) {
            if (vagasMultiplasSelecao.length < 2) {
                mostrarNotificacao('❌ Selecione pelo menos 2 vagas', 'erro');
                return;
            }
            
            var referencia = vagasMultiplasSelecao[0];
            var refPos = posicaoVagas[referencia.id];
            
            vagasMultiplasSelecao.slice(1).forEach(vaga => {
                var vagaId = vaga.id;
                if (tipo === 'horizontal') {
                    posicaoVagas[vagaId].y = refPos.y;
                    vaga.style.top = refPos.y + 'px';
                } else {
                    posicaoVagas[vagaId].x = refPos.x;
                    vaga.style.left = refPos.x + 'px';
                }
            });
            
            mostrarNotificacao(`↔️ ${vagasMultiplasSelecao.length} vagas alinhadas ${tipo}mente`, 'sucesso');
        }

        function excluirVagasMultiplas() {
            if (vagasMultiplasSelecao.length === 0) {
                mostrarNotificacao('❌ Nenhuma vaga selecionada', 'erro');
                return;
            }
            
            if
